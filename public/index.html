<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¬ãƒãƒ£ãƒãƒ³</title>

    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <h1>ğŸ ã‚¬ãƒãƒ£ãƒãƒ³</h1>
</header>

<!-- â–¼ ã‚¿ãƒ– -->
<div class="tab-buttons">
    <button class="tab-btn active" data-tab="gacha">ã‚¬ãƒãƒ£ãƒãƒ³</button>
    <button class="tab-btn" data-tab="collection">ãƒã‚¤ã‚³ãƒ¬</button>
    <button class="tab-btn" data-tab="admin">ç®¡ç†</button>
</div>

<!-- =====================================================
    â–¼ ã‚¬ãƒãƒ£ãƒãƒ³ç”»é¢
===================================================== -->
<div id="gacha" class="tab-content active">

    <h2>ã‚¬ãƒãƒ£ã‚’å›ãã†ï¼</h2>

    <!-- æ®‹ã‚Šå›æ•° -->
    <p>ğŸ”” æ®‹ã‚Šå›æ•°ï¼š<span id="spinsDisplay">0</span></p>

    <!-- ã‚·ãƒªã‚¢ãƒ«å…¥åŠ›ã§å›æ•°è¿½åŠ  -->
    <div class="serial-box">
        <input id="serialInput" placeholder="ã‚·ãƒªã‚¢ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›" />
        <button onclick="redeemSerial()">è¿½åŠ </button>
    </div>

    <!-- ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆæ®‹æ•° -->
    <p id="completeText" class="complete-text">ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã¾ã§æ®‹ã‚Š ??? ç¨®é¡ï¼</p>

    <!-- ã‚¬ãƒãƒ£ç­ä½“ -->
    <div class="gacha-area">
        <img id="gachaImage" class="gacha-img" src="gachapon.png" />
        <div id="videoArea"></div>
    </div>

    <!-- ã‚¬ãƒãƒ£ãƒœã‚¿ãƒ³ -->
    <div class="spin-buttons">
        <button id="spinButton" class="spin-btn">å›ã™ï¼</button>
        <button id="spin10Button" class="spin-btn pink">10é€£ã§å›ã™ï¼</button>
    </div>

</div>


<!-- =====================================================
    â–¼ ãƒã‚¤ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
===================================================== -->
<div id="collection" class="tab-content">

    <h2>ãƒã‚¤ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆã„ã¤ã§ã‚‚å‹•ç”»å†ç”Ÿå¯èƒ½ï¼‰</h2>

    <!-- â–¼ ãƒ¬ã‚¢åº¦ï¼šsuperrare -->
    <div class="rarity-block super-block">
        <h3 class="rarity-title super-title">SUPER RARE</h3>
        <div id="row-superrare" class="rarity-row"></div>
    </div>

    <!-- â–¼ ãƒ¬ã‚¢åº¦ï¼šrare -->
    <div class="rarity-block rare-block">
        <h3 class="rarity-title rare-title">RARE</h3>
        <div id="row-rare" class="rarity-row"></div>
    </div>

    <!-- â–¼ ãƒ¬ã‚¢åº¦ï¼šcommon -->
    <div class="rarity-block common-block">
        <h3 class="rarity-title common-title">COMMON</h3>
        <div id="row-common" class="rarity-row"></div>
    </div>

    <!-- â–¼ ãƒ¬ã‚¢åº¦ï¼šnormal -->
    <div class="rarity-block normal-block">
        <h3 class="rarity-title normal-title">NORMAL</h3>
        <div id="row-normal" class="rarity-row"></div>
    </div>

</div>


<!-- =====================================================
    â–¼ ç®¡ç†ç”»é¢ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§é–‹é–‰ï¼‰
===================================================== -->
<div id="admin" class="tab-content">

    <h2>ç®¡ç†ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h2>

    <!-- ç®¡ç†ãƒ‘ã‚¹ -->
    <div class="admin-auth">
        <input id="adminPass" type="password" placeholder="ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" />
        <button id="adminLoginBtn">ãƒ­ã‚°ã‚¤ãƒ³</button>
    </div>

    <div id="adminPanel" style="display:none;">

        <!-- â–½ ãƒ¬ã‚¢åº¦ç¢ºç‡è¨­å®š -->
        <section class="admin-section">
            <h3>ğŸ² ãƒ¬ã‚¢åº¦ç¢ºç‡è¨­å®š</h3>
            <div class="rate-box">
                <label>superrare (%)ï¼š<input id="rateSuper" type="number" min="0"></label>
                <label>rare (%)ï¼š<input id="rateRare" type="number" min="0"></label>
                <label>common (%)ï¼š<input id="rateCommon" type="number" min="0"></label>
                <label>normal (%)ï¼š<input id="rateNormal" type="number" min="0"></label>
            </div>
            <button id="saveRateBtn">ä¿å­˜</button>
        </section>

        <!-- â–½ æ™¯å“ç™»éŒ² -->
        <section class="admin-section">
            <h3>ğŸ“¦ æ™¯å“å‹•ç”»ã®ç™»éŒ²</h3>

            <select id="prizeRarity">
                <option value="superrare">SUPER RARE</option>
                <option value="rare">RARE</option>
                <option value="common">COMMON</option>
                <option value="normal">NORMAL</option>
            </select>

            <input id="prizeFile" type="file" accept="video/*" />

            <button id="addPrizeBtn">ç™»éŒ²</button>

            <h4>ç™»éŒ²æ¸ˆã¿æ™¯å“ä¸€è¦§</h4>
            <div id="prizeList" class="prize-list"></div>
        </section>

        <!-- â–½ ã‚·ãƒªã‚¢ãƒ«ç™ºè¡Œ -->
        <section class="admin-section">
            <h3>ğŸ”‘ ã‚·ãƒªã‚¢ãƒ«ã‚³ãƒ¼ãƒ‰ç™ºè¡Œ</h3>

            <input id="serialWord" placeholder="å¥½ããªæ–‡å­—åˆ—ã‚’å…¥åŠ›ï¼ˆä¾‹ï¼šyuu2025ï¼‰ã€>
            <input id="serialSpins" type="number" min="1" placeholder="ä»˜ä¸å›æ•°">

            <button id="issueSerialBtn">ç™ºè¡Œ</button>

            <h4>ç›´è¿‘ã®ç™ºè¡Œå±¥æ­´</h4>
            <div id="serialLog" class="serial-log"></div>
        </section>

    </div>

</div>


<script src="app.js"></script>

<script>
/* ==========================================================
    â–¼ ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
========================================================== */
const tabs = document.querySelectorAll(".tab-btn");
const contents = document.querySelectorAll(".tab-content");

tabs.forEach(btn => {
    btn.addEventListener("click", () => {
        tabs.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        contents.forEach(c => c.classList.remove("active"));
        document.getElementById(btn.dataset.tab).classList.add("active");
    });
});

/* ==========================================================
    â–¼ ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³
========================================================== */
document.getElementById("adminLoginBtn").onclick = async () => {
    const pw = document.getElementById("adminPass").value;

    const res = await fetch("/api/admin/login", {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({ password: pw })
    });
    const data = await res.json();

    if (!data.ok) {
        alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™ï¼");
        return;
    }

    document.getElementById("adminPanel").style.display = "block";
};
</script>

</body>
</html>
